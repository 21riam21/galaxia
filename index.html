<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Galaxia Interactiva ğŸ’«</title>
<style>
Â  html,body{margin:0;height:100%;background:#000;overflow:hidden}
Â  #galaxy-canvas{position:fixed;inset:0;width:100%;height:100%;display:block}
Â  .hud{position:fixed;left:10px;right:10px;bottom:10px;display:flex;gap:8px;align-items:center;
Â  Â  Â  Â background:rgba(20,15,35,.25);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:8px;
Â  Â  Â  Â backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);color:#fff;font-family:sans-serif}
Â  .hud button{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04);color:#fff}
Â  .hud input[type=file]{display:none}
Â  .pill{position:fixed;top:10px;left:50%;transform:translateX(-50%);padding:6px 12px;border-radius:999px;
Â  Â  Â  Â  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#fff;font:12px system-ui}
</style>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
<canvas id="galaxy-canvas"></canvas>
<div class="pill">Arrastra â€¢ Pinch/rueda â€¢ Doble toque: efecto</div>
<div class="hud">
Â  <button id="playBtn">â–¶ï¸</button>
Â  <span style="font-size:12px;opacity:.9">Selecciona tu MP3</span>
Â  <input type="file" id="pickFile" accept="audio/*">
Â  <button id="pickBtn">Elegir canciÃ³n</button>
Â  <audio id="audio" preload="none"></audio>
</div>

<script>
const CONFIG = {
Â  theme: 'opalita',Â 
Â  songFile: 'opalite.mp3', // AsegÃºrate de que este archivo estÃ© en la misma carpeta
Â  phrases: [
Â  Â  'Cesiah Keren ğŸ’›','Mi amor ğŸ’›','Mi niÃ±a hermosa ğŸ˜','Mi cielo ğŸŒŒ','Eres mi todo âœ¨',
Â  Â  'Siempre tÃº â™¾ï¸','Gracias por esta oportunidad ğŸ™','Te ADORO ğŸ¥°','Me encantas ğŸ’«',
Â  Â  'Amo todo de ti â™¥ï¸','Amo tus ojitos hermosos ğŸ¥°','Mi pequeÃ±a ğŸ’›','Eres el amor de todas mis vidas â™¥ï¸','Mi esposa posa posa ğŸ’',
Â  Â  'Eres la estrella mÃ¡s bonita que he visto ğŸŒ ','Mi vida ğŸ’–','Amo el brillo de tus ojitos âœ¨','Eres mi sueÃ±o hecho realidad ğŸ’›','Te quiero de aquÃ­ a la Luna mil veces ğŸŒ™',
Â  Â  'La mujer de mi vida ğŸ’›','Completamente enamorado de ti ğŸ’˜','No te voy a fallar, pequeÃ±a â™¥ï¸','Quiero que seas tÃº ğŸ’–', 'Tus ojos son mi constelaciÃ³n ğŸ‘ï¸âœ¨',
Â  Â  'Solo tÃº iluminas mi Ã³rbita ğŸ’¡ğŸ’«','Somos caos y universo juntos ğŸŒ€â™¾ï¸'
Â  ],
Â  highlightPhrases: [Â 
Â  Â  'K + R ğŸ’›',Â 
Â  Â  'Por siempre JUNTOS â™¾ï¸',
Â  Â  'But now the sky Opalite ğŸŒŒ'Â 
Â  ]
};

// ==== AUDIO ====
const audio=document.getElementById('audio');
audio.src=CONFIG.songFile;
const playBtn=document.getElementById('playBtn');
const pickBtn=document.getElementById('pickBtn');
const pickFile=document.getElementById('pickFile');

// ğŸš¨ NUEVA LÃ“GICA: Inicia el audio al primer clic en cualquier parte de la pÃ¡gina
let hasStartedAudio = false;

document.addEventListener('click', () => {
  if (!hasStartedAudio && audio.paused) {
    audio.play().then(() => {
      // Ã‰xito en la reproducciÃ³n
      hasStartedAudio = true;
      playBtn.textContent = 'â¸ï¸';
      audio.loop = true; // Aseguramos que se repita
    }).catch(error => {
      // Falla al reproducir (navegador estricto)
      console.log('Error al iniciar audio: ', error);
      // Dejamos que el usuario use el botÃ³n de Play si es necesario
    });
  }
});


playBtn.onclick=async()=>{
Â  if(audio.paused){
    await audio.play();
    playBtn.textContent='â¸ï¸';
    hasStartedAudio = true;
    audio.loop = true;
  }
Â  else{
    audio.pause();
    playBtn.textContent='â–¶ï¸';
  }
};
pickBtn.onclick=()=>pickFile.click();
pickFile.onchange=()=>{
Â  if(pickFile.files[0]){
Â  Â  const url=URL.createObjectURL(pickFile.files[0]);
Â  Â  audio.src=url; 
    audio.play(); 
    playBtn.textContent='â¸ï¸';
    hasStartedAudio = true;
    audio.loop = true;
Â  }
};

// ==== THREE.JS ====
const canvas=document.getElementById('galaxy-canvas');
const renderer=new THREE.WebGLRenderer({canvas,antialias:true});
renderer.setPixelRatio(Math.min(2,window.devicePixelRatio||1));
renderer.setSize(window.innerWidth,window.innerHeight);

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,2000);
camera.position.set(0,12,150);
const controls=new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;

// Fondo estrellado
function makeStarTexture(){
Â  const c=document.createElement('canvas'); c.width=c.height=1024;
Â  const g=c.getContext('2d');Â 
Â  g.fillStyle='#000000'; // Negro Puro
Â  g.fillRect(0,0,1024,1024);
Â  for(let i=0;i<2400;i++){
Â  Â  g.fillStyle='rgba(255,255,255,'+(Math.random()*0.9)+')';Â 
Â  Â  g.fillRect(Math.random()*1024,Math.random()*1024,1,1);
Â  }
Â  return new THREE.CanvasTexture(c);
}
scene.add(new THREE.Mesh(new THREE.SphereGeometry(600,64,64),
Â  new THREE.MeshBasicMaterial({map:makeStarTexture(),side:THREE.BackSide})));

// Tema
let themeColor=0xade8f4; // Color Opalita (Celeste pÃ¡lido/iridiscente)
if(CONFIG.theme==='pink')themeColor=0xff66cc;
if(CONFIG.theme==='red')themeColor=0xff4444;

// ==== FRASES ORBITANDO ====
const galaxy=new THREE.Group(); scene.add(galaxy);

// FUNCIÃ“N para mezclar el array de frases
function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

// 1. Crear el Pool de frases NORMALES (6 copias de cada una)
let phrasePool=[];
const NORMAL_REPS = 6;
for(let i=0; i<NORMAL_REPS; i++){
Â  Â  phrasePool.push(...CONFIG.phrases);
}

// 2. Agregar las frases DESTACADAS (2 copias de cada una)Â 
const HIGHLIGHT_REPS = 2;Â 
for(let i=0; i<HIGHLIGHT_REPS; i++){
Â  Â  phrasePool.push(...CONFIG.highlightPhrases);
}

const totalSprites = phrasePool.length;

// 3. Mezclamos todo el pool DE UNA SOLA VEZ antes de crear los sprites
shuffle(phrasePool);

for(let i=0;i<totalSprites;i++){
Â  // Usamos el Ã­ndice i para asignar el texto del pool y la posiciÃ³n angular
Â  const text=phrasePool[i];

Â  // aumentamos tamaÃ±o de lienzo para que no se recorten
Â  const c=document.createElement('canvas');
Â  c.width=1024; c.height=128;
Â  const g=c.getContext('2d');
Â Â 
Â  let fontSize=38;
Â  let glow=14;
Â Â 
Â  // Aplicamos el estilo de destacado
Â  if(CONFIG.highlightPhrases.includes(text)){
Â  Â  fontSize=70;Â 
Â  Â  glow=40;Â 
Â  }

Â  g.font=`bold ${fontSize}px Arial`;
Â  g.fillStyle='#fff';
Â  // El color de la sombra/brillo de las frases usa el themeColor Opalita
Â  g.shadowColor=`rgba(${(themeColor>>16)&255},${(themeColor>>8)&255},${themeColor&255},1)`;
Â  g.shadowBlur=glow;
Â  g.textAlign='center';
Â  g.textBaseline='middle';
Â  g.fillText(text,c.width/2,c.height/2);
Â  const tex=new THREE.CanvasTexture(c);

Â  const spr=new THREE.Sprite(new THREE.SpriteMaterial({map:tex,transparent:true,depthWrite:false}));
Â  // Rango de palabras: 85 a 135
Â  const angle=(i/totalSprites)*Math.PI*2+Math.random()*0.3;Â 
Â  const dist=85+Math.random()*50; // distancia mayor
Â  const height=(Math.random()-0.5)*40;
Â  spr.position.set(Math.cos(angle)*dist,height,Math.sin(angle)*dist);
Â  spr.scale.set(20*(fontSize/32),4*(fontSize/32),1);

Â  galaxy.add(spr);
}

// ==== NÃšCLEO Y PARTÃCULAS ====
const color=new THREE.Color(themeColor);

// NÃºcleo
const coreGeometry=new THREE.SphereGeometry(10,64,64);
const coreMaterial=new THREE.MeshPhongMaterial({
Â  color, emissive:color, emissiveIntensity:0.8, shininess:60,
Â  transparent:true, opacity:0.95
});
const core=new THREE.Mesh(coreGeometry,coreMaterial);
scene.add(core);

// Halo mÃ¡s grande
const glowGeometry=new THREE.SphereGeometry(35,64,64);
const glowMaterial=new THREE.MeshBasicMaterial({
Â  color, transparent:true, opacity:0.18,Â 
Â  blending:THREE.AdditiveBlending, side:THREE.BackSide
});
const glow=new THREE.Mesh(glowGeometry,glowMaterial);
scene.add(glow);

// PartÃ­culas exteriores
const particleCount=3500;
const positions=new Float32Array(particleCount*3);
const speeds=new Float32Array(particleCount);
// Velocidad lenta
const baseSpeed=0.0003; 
for(let i=0;i<particleCount;i++){
Â  // Rango de partÃ­culas: 70 a 180.
Â  const r=70+Math.random()*110;Â 
Â  const a=Math.random()*Math.PI*2;
Â  const y=(Math.random()-0.5)*40;
Â  positions[i*3]=Math.cos(a)*r;
Â  positions[i*3+1]=y;
Â  positions[i*3+2]=Math.sin(a)*r;
Â  speeds[i]=baseSpeed;
}
const pGeo=new THREE.BufferGeometry();
pGeo.setAttribute('position',new THREE.BufferAttribute(positions,3));
const pMat=new THREE.PointsMaterial({
Â  color:themeColor,size:0.28,transparent:true,opacity:0.9,
Â  blending:THREE.AdditiveBlending
});
const orbitParticles=new THREE.Points(pGeo,pMat);
scene.add(orbitParticles);

// PartÃ­culas nÃºcleo
const coreParticleCount=1500;
const corePos=new Float32Array(coreParticleCount*3);
const coreAngles=new Float32Array(coreParticleCount);
const coreRadius=new Float32Array(coreParticleCount);
for(let i=0;i<coreParticleCount;i++){
Â  const r=Math.random()*10;
Â  const theta=Math.random()*Math.PI*2;
Â  const phi=Math.acos((Math.random()*2)-1);
Â  corePos[i*3]=r*Math.sin(phi)*Math.cos(theta);
Â  corePos[i*3+1]=r*Math.sin(phi)*Math.sin(theta);
Â  corePos[i*3+2]=r*Math.cos(phi);
Â  coreAngles[i]=Math.random()*Math.PI*2;
Â  coreRadius[i]=r;
}
const coreGeo=new THREE.BufferGeometry();
coreGeo.setAttribute('position',new THREE.BufferAttribute(corePos,3));
const coreMat2=new THREE.PointsMaterial({
Â  color:themeColor,size:0.38,transparent:true,opacity:0.95,
Â  blending:THREE.AdditiveBlending
});
const innerParticles=new THREE.Points(coreGeo,coreMat2);
scene.add(innerParticles);

// PartÃ­culas intermedias
const midParticleCount=5000;
const midPositions=new Float32Array(midParticleCount*3);
const midSpeeds=new Float32Array(midParticleCount);
for(let i=0;i<midParticleCount;i++){
Â  const r=15+Math.random()*55;
Â  const theta=Math.random()*Math.PI*2;
Â  const phi=Math.acos((Math.random()*2)-1);
Â  midPositions[i*3]=r*Math.sin(phi)*Math.cos(theta);
Â  midPositions[i*3+1]=r*Math.sin(phi)*Math.sin(theta);
Â  midPositions[i*3+2]=r*Math.cos(phi);
Â  midSpeeds[i]=baseSpeed;
}
const midGeo=new THREE.BufferGeometry();
midGeo.setAttribute('position',new THREE.BufferAttribute(midPositions,3));
const midMat=new THREE.PointsMaterial({
Â  color:themeColor,size:0.25,transparent:true,opacity:0.88,
Â  blending:THREE.AdditiveBlending
});
const midParticles=new THREE.Points(midGeo,midMat);
scene.add(midParticles);

// Luces
scene.add(new THREE.AmbientLight(0xffffff,0.5));
const light=new THREE.PointLight(themeColor,1.2,350);Â 
light.position.set(0,20,60);
scene.add(light);

// ==== ANIMACIÃ“N ====
function animate(){
Â  requestAnimationFrame(animate);

Â  // Las rotaciones usan baseSpeed
Â  galaxy.rotation.y += baseSpeed*2;Â 
Â  core.rotation.y += baseSpeed*2;
Â  glow.rotation.y += baseSpeed*2;

Â  // partÃ­culas externas
Â  const pos=orbitParticles.geometry.attributes.position.array;
Â  for(let i=0;i<particleCount;i++){
Â  Â  const x=pos[i*3];
Â  Â  const z=pos[i*3+2];
Â  Â  // La velocidad angular usa speeds[i] que se inicializÃ³ con baseSpeed
Â  Â  const angle=Math.atan2(z,x)-speeds[i];Â 
Â  Â  const r=Math.sqrt(x*x+z*z);
Â  Â  pos[i*3]=Math.cos(angle)*r;
Â  Â  pos[i*3+2]=Math.sin(angle)*r;
Â  }
Â  orbitParticles.geometry.attributes.position.needsUpdate=true;

Â  // partÃ­culas intermedias
Â  const midArray=midParticles.geometry.attributes.position.array;
Â  for(let i=0;i<midParticleCount;i++){
Â  Â  const x=midArray[i*3];
Â  Â  const z=midArray[i*3+2];
Â  Â  const angle=Math.atan2(z,x)-midSpeeds[i];
Â  Â  const r=Math.sqrt(x*x+z*z);
Â  Â  midArray[i*3]=Math.cos(angle)*r;
Â  Â  midArray[i*3+2]=Math.sin(angle)*r;
Â  }
Â  midParticles.geometry.attributes.position.needsUpdate=true;

Â  // partÃ­culas del nÃºcleo
Â  const corePositions=innerParticles.geometry.attributes.position.array;
Â  for(let i=0;i<coreParticleCount;i++){
Â  Â  // TambiÃ©n usa baseSpeed para su movimiento
Â  Â  coreAngles[i]-=baseSpeed;
Â  Â  const r=coreRadius[i];
Â  Â  corePositions[i*3]=Math.cos(coreAngles[i])*r;
Â  Â  corePositions[i*3+2]=Math.sin(coreAngles[i])*r;
Â  }
Â  innerParticles.geometry.attributes.position.needsUpdate=true;

Â  controls.update();
Â  renderer.render(scene,camera);
}
animate();

window.addEventListener('resize',()=>{
Â  camera.aspect=window.innerWidth/window.innerHeight;
Â  camera.updateProjectionMatrix();
Â  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>














